# BUG-2025-001: Androidドラッグドロップ安定化

## 問題の説明
Android環境でのドラッグ&ドロップ操作が不安定で、以下の問題が発生している：
1. 子を持ったタスクの並び替えで動作が不安定
2. 並び替え動作が途中で固まる
3. ドラッグ操作の応答性が悪い

## 再現手順
1. Android端末でアプリを起動
2. 子タスクを持つ親タスクを作成
3. そのタスクをドラッグして並び替えを試行
4. または、複数タスクを連続してドラッグ操作

## 期待される動作
- スムーズなドラッグ&ドロップ操作
- 子を持つタスクも安定して並び替え可能
- 操作が途中で固まることがない

## 実際の動作
- 子を持つタスクのドラッグで動作が不安定
- 並び替え操作が途中でフリーズする
- タッチ応答が遅延する場合がある

## 影響範囲
- **重要度**: High
- **影響ユーザー**: Android端末利用者全般
- **回避策**: アプリ再起動で一時的に改善

## 環境情報
- **プラットフォーム**: React Native / Expo
- **OS**: Android
- **関連ライブラリ**: react-native-draggable-flatlist, react-native-gesture-handler, react-native-reanimated

## 原因調査
- **推定原因**: 
  - Android特有のジェスチャーハンドリング問題
  - 階層構造を持つタスクの描画とドラッグ処理の競合
  - react-native-gesture-handlerの設定不備
- **関連ファイル**: 
  - src/hooks/useTasks.js (タスク管理ロジック)
  - src/components/TaskItem.js (タスクアイテム表示)
  - App.js (DraggableFlatListの実装)

## 修正方針
- **アプローチ**: 
  1. Android向けジェスチャー設定の最適化
  2. ドラッグ中のパフォーマンス改善
  3. 階層構造タスクの描画最適化
- **変更ファイル**: 
  - App.js (DraggableFlatListの設定調整)
  - src/components/TaskItem.js (レンダリング最適化)
  - src/hooks/useTasks.js (状態管理改善)
- **テスト項目**: 
  1. 子を持つタスクのドラッグ&ドロップ
  2. 連続ドラッグ操作の安定性
  3. 長時間操作での動作確認

## Claude Code指示
このバグを修正する際は以下を確認してください：
1. react-native-gesture-handlerのAndroid固有設定を確認
2. DraggableFlatListのパフォーマンス関連プロパティを調整
3. TaskItemコンポーネントのメモ化とレンダリング最適化
4. 実機Android端末での動作テストを実施

注意: iOS環境での動作に影響しないよう、プラットフォーム固有の対応を検討する

## 作業ログ
- 2025-08-21 15:02 - バグ報告 ([報告者])
- 2025-08-21 15:02 - 調査開始
- 2025-08-21 15:02 - [調査・修正内容]

---
**ラベル**: bug, [重要度タグ]
**担当**: [担当者名またはClaude Code]
**期限**: [YYYY-MM-DD]- 2025-08-21 15:03 - backlog → todo へ移動
- 2025-08-21 15:04 - 作業開始
- 2025-08-21 15:28 - 作業完了（レビュー待ち）
- 2025-08-21 15:28 - review → done へ移動
