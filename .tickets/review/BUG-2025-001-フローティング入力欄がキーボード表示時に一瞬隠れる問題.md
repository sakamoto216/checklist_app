# BUG-2025-001: フローティング入力欄がキーボード表示時に一瞬隠れる問題

## 問題の説明
タスク追加時のフローティング入力欄でキーボードが表示される際に、一瞬入力欄が隠れてから正しい位置に表示される問題

## 再現手順
1. アプリを起動してタスクリストを表示
2. タスク追加ボタン（+）をタップ
3. フローティング入力欄が表示される際の動作を観察

## 期待される動作
キーボードが表示されると同時にフローティング入力欄が適切な位置に表示され、ちらつきなく入力可能な状態になる

## 実際の動作
キーボードが表示される瞬間に入力欄が一瞬隠れ、その後に正しい位置に再表示される。視覚的にちらつきが発生

## 影響範囲
- **重要度**: High
- **影響ユーザー**: 全ユーザー（タスク追加機能利用時）
- **回避策**: 特になし（機能的には問題ないがUX的に違和感）

## 環境情報
- **プラットフォーム**: React Native/Expo
- **OS**: iOS/Android両方
- **バージョン**: React Native 0.79.5, Expo 53.0.20

## 原因調査
- **推定原因**: KeyboardAvoidingViewやキーボード表示時の位置調整ロジックのタイミング問題
- **関連ファイル**: 
  - src/components/FloatingTaskEditor.js
  - src/hooks/useKeyboard.js
  - App.js
- **エラーログ**: なし（機能的エラーではない）

## 修正方針
- **アプローチ**: キーボード表示時の位置調整タイミングを最適化し、初期表示位置を適切に設定
- **変更ファイル**: FloatingTaskEditor.js、useKeyboard.js（必要に応じて）
- **テスト項目**: 
  - iOS実機でのタスク追加時の表示確認
  - Android実機での同様確認
  - キーボード表示・非表示時のアニメーション確認

## Claude Code指示
このバグを修正する際は以下を確認してください：
1. FloatingTaskEditor.jsの実装を調査し、キーボード表示時の位置調整ロジックを確認
2. useKeyboard.jsのキーボード制御ロジックを調査
3. KeyboardAvoidingViewの設定とアニメーションタイミングを確認
4. 修正後はiOS/Android両方で動作確認を実施

注意: パフォーマンスに影響しないよう、過度なre-renderを避ける

## 作業ログ
- 2025-07-30 17:32 - バグ報告（ユーザー）
- 2025-07-30 17:32 - チケット作成
- 2025-07-30 17:32 - 調査開始、関連コンポーネント確認完了
- 2025-07-30 17:32 - 原因特定：keyboardDidShowイベントの遅延とデフォルト位置の問題
- 2025-07-30 17:32 - 修正実装：
  - useKeyboard.jsにkeyboardWillShow(iOS)イベント追加
  - FloatingTaskEditor.jsでプラットフォーム別推定キーボード高さ実装
  - アニメーション設定を"none"に変更してちらつき軽減

---
**ラベル**: bug, high-priority, ux-improvement
**担当**: Claude Code
**期限**: 2025-07-30- 2025-07-30 17:33 - backlog → todo へ移動
- 2025-07-30 17:33 - 作業開始
- 2025-07-30 17:35 - 作業完了（レビュー待ち）
